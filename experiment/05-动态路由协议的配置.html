<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.61">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/icons/favicon.png"><meta name="theme-color" content="#3eaf7c"><link rel="manifest" href="/manifest.webmanifest"><title>5. 动态路由协议的配置 | Computer Network Learning</title><meta name="description" content="关于 CWorld 学习该课程的一些笔记。">
    <link rel="preload" href="/assets/style-a57c0936.css" as="style"><link rel="stylesheet" href="/assets/style-a57c0936.css">
    <link rel="modulepreload" href="/assets/app-3050c8f9.js"><link rel="modulepreload" href="/assets/framework-5866ffd3.js"><link rel="modulepreload" href="/assets/05-动态路由协议的配置.html-2372ba05.js"><link rel="modulepreload" href="/assets/05-动态路由协议的配置.html-6fc0d6f3.js"><link rel="prefetch" href="/assets/01-introduction.html-ed15be02.js" as="script"><link rel="prefetch" href="/assets/02-application-layer.html-7dd0ca4c.js" as="script"><link rel="prefetch" href="/assets/03-transport-layer.html-8ee0ee9c.js" as="script"><link rel="prefetch" href="/assets/index.html-61b3ac20.js" as="script"><link rel="prefetch" href="/assets/intro.html-369b01cb.js" as="script"><link rel="prefetch" href="/assets/01-网络基础知识及双绞线的制作.html-15c983ef.js" as="script"><link rel="prefetch" href="/assets/02-交换机配置及VLAN建立.html-e731147c.js" as="script"><link rel="prefetch" href="/assets/03-三层交换及VLAN间路由.html-dfab0257.js" as="script"><link rel="prefetch" href="/assets/04-路由器基本配置及静态路由配置.html-a0862f25.js" as="script"><link rel="prefetch" href="/assets/Getting Started.html-fe6ee8b4.js" as="script"><link rel="prefetch" href="/assets/404.html-f9875e7b.js" as="script"><link rel="prefetch" href="/assets/01-introduction.html-16852858.js" as="script"><link rel="prefetch" href="/assets/02-application-layer.html-60a04521.js" as="script"><link rel="prefetch" href="/assets/03-transport-layer.html-938bdb4f.js" as="script"><link rel="prefetch" href="/assets/index.html-b809455c.js" as="script"><link rel="prefetch" href="/assets/intro.html-5ec6dbed.js" as="script"><link rel="prefetch" href="/assets/01-网络基础知识及双绞线的制作.html-9d277d41.js" as="script"><link rel="prefetch" href="/assets/02-交换机配置及VLAN建立.html-f079078e.js" as="script"><link rel="prefetch" href="/assets/03-三层交换及VLAN间路由.html-2279f06f.js" as="script"><link rel="prefetch" href="/assets/04-路由器基本配置及静态路由配置.html-d03cf05a.js" as="script"><link rel="prefetch" href="/assets/Getting Started.html-2b01ca79.js" as="script"><link rel="prefetch" href="/assets/404.html-87d54bd8.js" as="script"><link rel="prefetch" href="/assets/index-70769223.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><!----><span class="site-name">Computer Network Learning</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/" class="" aria-label="Home"><!--[--><!--]--> Home <!--[--><!--]--></a></div><div class="navbar-item"><a href="/intro.md" class="" aria-label="Intro"><!--[--><!--]--> Intro <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://blog.cworld.top" rel="noopener noreferrer" target="_blank" aria-label="Blog"><!--[--><!--]--> Blog <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="Search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/" class="" aria-label="Home"><!--[--><!--]--> Home <!--[--><!--]--></a></div><div class="navbar-item"><a href="/intro.md" class="" aria-label="Intro"><!--[--><!--]--> Intro <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://blog.cworld.top" rel="noopener noreferrer" target="_blank" aria-label="Blog"><!--[--><!--]--> Blog <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">Tutorial <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/index.md" class="sidebar-item" aria-label="Home"><!--[--><!--]--> Home <!--[--><!--]--></a><!----></li><li><a href="/intro.md" class="sidebar-item" aria-label="Intro"><!--[--><!--]--> Intro <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading">Main Chapters <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/01-introduction.html" class="sidebar-item" aria-label="Chapter 1: Introduction"><!--[--><!--]--> Chapter 1: Introduction <!--[--><!--]--></a><!----></li><li><a href="/02-application-layer.html" class="sidebar-item" aria-label="Chapter 2: Application Layer"><!--[--><!--]--> Chapter 2: Application Layer <!--[--><!--]--></a><!----></li><li><a href="/03-transport-layer.html" class="sidebar-item" aria-label="Chapter 3: Transport Layer"><!--[--><!--]--> Chapter 3: Transport Layer <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading active">Experiments <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/experiment/01-%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E5%8F%8A%E5%8F%8C%E7%BB%9E%E7%BA%BF%E7%9A%84%E5%88%B6%E4%BD%9C.html" class="sidebar-item" aria-label="1. 网络基础知识及双绞线的制作"><!--[--><!--]--> 1. 网络基础知识及双绞线的制作 <!--[--><!--]--></a><!----></li><li><a href="/experiment/02-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E9%85%8D%E7%BD%AE%E5%8F%8AVLAN%E5%BB%BA%E7%AB%8B.html" class="sidebar-item" aria-label="2. 交换机配置及 VLAN 建立"><!--[--><!--]--> 2. 交换机配置及 VLAN 建立 <!--[--><!--]--></a><!----></li><li><a href="/experiment/03-%E4%B8%89%E5%B1%82%E4%BA%A4%E6%8D%A2%E5%8F%8AVLAN%E9%97%B4%E8%B7%AF%E7%94%B1.html" class="sidebar-item" aria-label="3. 三层交换及 VLAN 间路由"><!--[--><!--]--> 3. 三层交换及 VLAN 间路由 <!--[--><!--]--></a><!----></li><li><a href="/experiment/04-%E8%B7%AF%E7%94%B1%E5%99%A8%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE%E5%8F%8A%E9%9D%99%E6%80%81%E8%B7%AF%E7%94%B1%E9%85%8D%E7%BD%AE.html" class="sidebar-item" aria-label="4. 路由器基本配置及静态路由配置"><!--[--><!--]--> 4. 路由器基本配置及静态路由配置 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/experiment/05-%E5%8A%A8%E6%80%81%E8%B7%AF%E7%94%B1%E5%8D%8F%E8%AE%AE%E7%9A%84%E9%85%8D%E7%BD%AE.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="5. 动态路由协议的配置"><!--[--><!--]--> 5. 动态路由协议的配置 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/experiment/05-%E5%8A%A8%E6%80%81%E8%B7%AF%E7%94%B1%E5%8D%8F%E8%AE%AE%E7%9A%84%E9%85%8D%E7%BD%AE.html#实验目的" class="router-link-active router-link-exact-active sidebar-item" aria-label="实验目的"><!--[--><!--]--> 实验目的 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/experiment/05-%E5%8A%A8%E6%80%81%E8%B7%AF%E7%94%B1%E5%8D%8F%E8%AE%AE%E7%9A%84%E9%85%8D%E7%BD%AE.html#动态路由" class="router-link-active router-link-exact-active sidebar-item" aria-label="动态路由"><!--[--><!--]--> 动态路由 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/experiment/05-%E5%8A%A8%E6%80%81%E8%B7%AF%E7%94%B1%E5%8D%8F%E8%AE%AE%E7%9A%84%E9%85%8D%E7%BD%AE.html#实验步骤" class="router-link-active router-link-exact-active sidebar-item" aria-label="实验步骤"><!--[--><!--]--> 实验步骤 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="_5-动态路由协议的配置" tabindex="-1"><a class="header-anchor" href="#_5-动态路由协议的配置" aria-hidden="true">#</a> 5. 动态路由协议的配置</h1><h2 id="实验目的" tabindex="-1"><a class="header-anchor" href="#实验目的" aria-hidden="true">#</a> 实验目的</h2><p>掌握动态路由协议 RIP 和 OSPF 的配置方法。</p><h2 id="动态路由" tabindex="-1"><a class="header-anchor" href="#动态路由" aria-hidden="true">#</a> 动态路由</h2><p>动态路由（Dynamic Routing）是网络中的路由器之间相互通信，传递路由信息，利用收到的路由信息动态更新路由器表的过程。它能实时地适应网络结构的变化。如果路由更新信息表明发生了网络变化，路由选择软件就会重新计算路由，并发出新的路由更新信息。这些信息通过各个网络，引起各路由器重新启动其路由算法，并更新各自的路由表以动态地反映网络拓扑变化。动态路由适用于网络规模大、网络拓扑复杂的网络。当然，动态路由协议会不同程度地占用网络带宽和 CPU 资源。</p><p>在设置动态路由之前，先用命令 <code>delete static-routes all</code> 将所有静态路由删除。</p><h3 id="动态路由协议简述" tabindex="-1"><a class="header-anchor" href="#动态路由协议简述" aria-hidden="true">#</a> 动态路由协议简述</h3><blockquote><p><a href="https://zhuanlan.zhihu.com/p/164747890" target="_blank" rel="noopener noreferrer">动态路由协议概述 - 知乎 (zhihu.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>动态路由协议，就是<strong>路由器能够自己建立路由表</strong>，不需要管理员手动一条一条将路由加表，这样就节省了许多人力。同时当网络中出现故障时，路由器可以自行检测链路，并选择最优的路径进行数据转发。</p><p><strong>所有的动态路由协议在 TCP/IP 协议栈中都属于应用层的协议。但是不同的路由协议使用的底层协议不同。</strong></p><p>OSPF 将协议报文直接封装在 IP 报文中，协议号 89，由于 IP 协议本身是不可靠传输协议，所以<strong>OSPF 传输的可靠性需要协议本身来保证</strong>。</p><p><strong>BGP 使用 TCP 作为传输协议，提高了协议的可靠性，TCP 的端口号是 179。RIP 使用 UDP 作为传输协议，端口号 520。</strong></p><p>IS-IS 协议是开放系统互联（OSI）协议中的网络层协议，IS-IS 协议基础是 CLNP（Connectionless Network Protocol，无连接网络协议）。</p><p>所以，常见的动态路由有 RIP、OSPF、ISIS、BGP 等，其中 BGP 是唯一一个用于 AS 与 AS 之间的路由协议，其他三个都是用于 AS 内部的路由协议。</p><p><strong>动态路由共同具有的特点：</strong></p><ol><li>无需管理员手工维护，减轻了管理员的工作量。</li><li>占用了网络带宽。</li><li>在路由器上运行路由协议，使路由器可以自动根据网络拓扑结构的变化调整路由条目。</li></ol><p><strong>路由器协议性能指标：</strong></p><ul><li><p>正确性：能够正确找出最优的路由，且无自环。</p></li><li><p>快收敛：当网络的拓扑结构发生变换之后，能够迅速在自治系统中作相应的路由改变。</p></li><li><p>低开销：协议自身的开销（内存、CPU、网络带宽）最小。</p></li><li><p>安全性：协议自身不易受攻击，有安全机制。</p></li><li><p>普适性：适应各种拓扑结构和规模的网络。</p></li></ul></blockquote><p>IS-IS、OSPF 和 BGP 路由协议：</p><ul><li>IS-IS（Intermediate System to Intermediate System）是一种内部网关协议（IGP），用于在单个自治系统内部的路由选择。IS-IS 是一种链路状态路由协议，与 OSPF 类似，但是 IS-IS 使用 CLNS 协议来传输数据包，而 OSPF 使用 IP 协议来传输数据包。</li><li>OSPF（Open Shortest Path First）是一种内部网关协议（IGP），用于在单个自治系统内部的路由选择。OSPF 是基于 SPF 算法的链路状态路由协议，适用于分层网络拓扑或设计。</li><li>是一种外部网关协议（EGP），用于在不同自治系统之间的路由选择。BGP 是基于路径矢量路由协议，并适用于网状拓扑或设计。BGP 的路由表大小决定了所需的设备资源。</li></ul><h3 id="动态路由协议在协议栈中的位置" tabindex="-1"><a class="header-anchor" href="#动态路由协议在协议栈中的位置" aria-hidden="true">#</a> 动态路由协议在协议栈中的位置</h3><p><img src="/assets/image-20230328142309558-377fa7ee.png" alt="image-20230328142309558"></p><h3 id="现有路由协议的性能比较" tabindex="-1"><a class="header-anchor" href="#现有路由协议的性能比较" aria-hidden="true">#</a> 现有路由协议的性能比较</h3><p><img src="/assets/image-20230328143653203-b2c4c426.png" alt="image-20230328143653203"></p><h3 id="rip-协议" tabindex="-1"><a class="header-anchor" href="#rip-协议" aria-hidden="true">#</a> RIP 协议</h3><p>RIP 是 Routing Information Protocol（路由信息协议）的简称，是距离矢量路由协议的一个具体实现。（如今 RIP 已经不怎么用了）</p><p>RIP 协议适用于中小型网络，有 RIP-1 和 RIP-2。其中 RIP-2 使用组播（224.0.0.9）发送，支持验证和 VLSM。</p><p>RIP 支持：水平分割、路由中毒和触发更新。</p><p>RIP 协议配置命令：</p><ul><li><p><code>rip</code>：启动 RIP 协议，进入 RIP 协议配置视图</p></li><li><p><code>network network-number</code>：在指定的网络上使能 RIP</p></li><li><p><code>peer IP-address</code>：配置报文的定点传送（不支持广播时）</p></li><li><p><code>rip version 1</code>：指定接口版本 1（接口视图下）</p></li><li><p><code>rip version 2 [broadcast|multicast]</code>：指定接口版本 2</p></li></ul><h2 id="实验步骤" tabindex="-1"><a class="header-anchor" href="#实验步骤" aria-hidden="true">#</a> 实验步骤</h2><h3 id="step-1-搭建基本路由器网络" tabindex="-1"><a class="header-anchor" href="#step-1-搭建基本路由器网络" aria-hidden="true">#</a> STEP 1：搭建基本路由器网络</h3><p>按图示搭建网络环境：</p><p><img src="/assets/image-20230328140757649-1efc14d5.png" alt="image-20230328140757649"></p><p>1、通过超级终端，进入路由器 R1 的控制口并进行设置：</p><ul><li><code>system-view</code>：进入系统视图</li><li><code>sysname R1</code>：重命名路由器</li><li><code>interface Ethernet 0/0</code>：进入以太网 0 口的接口视图</li><li><code>ip address 202.0.0.1 24</code>：设置 ip 地址</li><li><code>interface serial 1/0</code>：进入串口的 1/0 口</li><li><code>ip address 192.0.0.1 24</code>：设置 ip 地址</li></ul><p>2、路由器 R2 的设置：</p><p>进入系统视图后，进入以太网 0 口的接口视图，设置 ip 地址：</p><ul><li><code>system-view</code>：进入系统视图</li><li><code>sysname R2</code>：重命名路由器</li><li><code>interface Ethernet 0/0</code>：进入以太网 0 口的接口视图</li><li><code>ip address 202.0.1.1 24</code>：设置 ip 地址</li><li><code>interface serial 2/0</code>：进入串口的 2/0 口</li><li><code>ip address 192.0.0.2 24</code>：设置 ip 地址</li></ul><p>3、设置 PC 的 IP 地址，并将网关指向所连接的路由器的以太口。</p><p>设置完成后，可以在路由器上看到以太口和串口的状态转为 Up，出现类似下面的提示：</p><div class="language-log line-numbers-mode" data-ext="log"><pre class="language-log"><code><span class="token operator">%</span><span class="token date number">Oct 22</span> <span class="token time number">17:19:16:602</span> <span class="token number">2007</span> RouteR1 IFNET<span class="token operator">/</span><span class="token number">5</span><span class="token operator">/</span>UPDOWN<span class="token operator">:</span>PPP IPCP protocol on the interface Serial0<span class="token operator">/</span><span class="token number">0</span> is UP
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>此时在 PC 上 ping 网关或本地路由器的串口，应该 ping 通 （请将多余的本地连接禁用），如果 ping 不通，请检查交换机的配置，是否有 vlan 阻止了数据包的通过。</p><p>但在 pc 上 ping 对端路由器的 ip 地址或其以太网上的 pc，不能 ping 通 ，这是因为本地路由器上还没有对方网段的路由信息，数据包无法获知到达对端的路径。</p></div><!--[--><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: cworld0@qq.com">cworld1</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/experiment/04-%E8%B7%AF%E7%94%B1%E5%99%A8%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE%E5%8F%8A%E9%9D%99%E6%80%81%E8%B7%AF%E7%94%B1%E9%85%8D%E7%BD%AE.html" class="" aria-label="4. 路由器基本配置及静态路由配置"><!--[--><!--]--> 4. 路由器基本配置及静态路由配置 <!--[--><!--]--></a></span><!----></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app-3050c8f9.js" defer></script>
  </body>
</html>
