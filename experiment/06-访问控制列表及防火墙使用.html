<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.62">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <meta property="og:url" content="https://cn.cworld.top/experiment/06-%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%88%97%E8%A1%A8%E5%8F%8A%E9%98%B2%E7%81%AB%E5%A2%99%E4%BD%BF%E7%94%A8.html"><meta property="og:site_name" content="Computer Network Learning"><meta property="og:title" content="6. 访问控制列表及防火墙使用"><meta property="og:description" content="实验目的 学习访问控制列表 ACL 的配置方法，学习防火墙的基本使用方法。 实验原理 IP 包过滤技术 对路由器需要转发的数据包，先获取包头信息，然后和设定的规则进行比较，根据比较的结果对数据包进行转发或者丢弃。而实现包过滤的核心技术是访问控制列表。 image-20230404211701800 访问控制列表 访问控制列表的作用： 访问控制列表可以用..."><meta property="og:type" content="article"><meta property="og:image" content="https://cn.cworld.top/"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2023-06-01T11:01:49.000Z"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image:alt" content="6. 访问控制列表及防火墙使用"><meta property="article:author" content="CWorld"><meta property="article:modified_time" content="2023-06-01T11:01:49.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"6. 访问控制列表及防火墙使用","image":["https://cn.cworld.top/"],"dateModified":"2023-06-01T11:01:49.000Z","author":[{"@type":"Person","name":"CWorld"}]}</script><link rel="icon" href="/icons/favicon.png"><meta name="theme-color" content="#3eaf7c"><link rel="manifest" href="/manifest.webmanifest"><title>6. 访问控制列表及防火墙使用 | Computer Network Learning</title><meta name="description" content="实验目的 学习访问控制列表 ACL 的配置方法，学习防火墙的基本使用方法。 实验原理 IP 包过滤技术 对路由器需要转发的数据包，先获取包头信息，然后和设定的规则进行比较，根据比较的结果对数据包进行转发或者丢弃。而实现包过滤的核心技术是访问控制列表。 image-20230404211701800 访问控制列表 访问控制列表的作用： 访问控制列表可以用...">
    <link rel="preload" href="/assets/style-22c397d2.css" as="style"><link rel="stylesheet" href="/assets/style-22c397d2.css">
    <link rel="modulepreload" href="/assets/app-179c21db.js"><link rel="modulepreload" href="/assets/06-访问控制列表及防火墙使用.html-4a09b10c.js"><link rel="modulepreload" href="/assets/06-访问控制列表及防火墙使用.html-e28d70f3.js"><link rel="prefetch" href="/assets/01-introduction.html-7d268cec.js" as="script"><link rel="prefetch" href="/assets/02-application-layer.html-46ee7ef5.js" as="script"><link rel="prefetch" href="/assets/03-transport-layer.html-e087f1e0.js" as="script"><link rel="prefetch" href="/assets/04-network-layer.html-037ec653.js" as="script"><link rel="prefetch" href="/assets/05-network-layer-2.html-d2d374ce.js" as="script"><link rel="prefetch" href="/assets/06-link-layer-and-lans.html-af932771.js" as="script"><link rel="prefetch" href="/assets/index.html-70ae77f3.js" as="script"><link rel="prefetch" href="/assets/intro.html-e4a31817.js" as="script"><link rel="prefetch" href="/assets/00-getting-started.html-729a75d1.js" as="script"><link rel="prefetch" href="/assets/01-网络基础知识及双绞线的制作.html-8caad387.js" as="script"><link rel="prefetch" href="/assets/02-交换机配置及VLAN建立.html-85d91d02.js" as="script"><link rel="prefetch" href="/assets/03-三层交换及VLAN间路由.html-3b1bfb19.js" as="script"><link rel="prefetch" href="/assets/04-路由器基本配置及静态路由配置.html-174a6d90.js" as="script"><link rel="prefetch" href="/assets/05-动态路由协议的配置.html-30e5dbc1.js" as="script"><link rel="prefetch" href="/assets/07-应用服务器的配置.html-f73ca585.js" as="script"><link rel="prefetch" href="/assets/404.html-29cf9d4c.js" as="script"><link rel="prefetch" href="/assets/01-introduction.html-41b8a584.js" as="script"><link rel="prefetch" href="/assets/02-application-layer.html-c77e7114.js" as="script"><link rel="prefetch" href="/assets/03-transport-layer.html-496b048a.js" as="script"><link rel="prefetch" href="/assets/04-network-layer.html-a38f2814.js" as="script"><link rel="prefetch" href="/assets/05-network-layer-2.html-2ea89270.js" as="script"><link rel="prefetch" href="/assets/06-link-layer-and-lans.html-21f87f25.js" as="script"><link rel="prefetch" href="/assets/index.html-debe4368.js" as="script"><link rel="prefetch" href="/assets/intro.html-3905dfaf.js" as="script"><link rel="prefetch" href="/assets/00-getting-started.html-4f2a8c8d.js" as="script"><link rel="prefetch" href="/assets/01-网络基础知识及双绞线的制作.html-027055ea.js" as="script"><link rel="prefetch" href="/assets/02-交换机配置及VLAN建立.html-e0faa703.js" as="script"><link rel="prefetch" href="/assets/03-三层交换及VLAN间路由.html-9cca7fd3.js" as="script"><link rel="prefetch" href="/assets/04-路由器基本配置及静态路由配置.html-0e3118ce.js" as="script"><link rel="prefetch" href="/assets/05-动态路由协议的配置.html-3c45262e.js" as="script"><link rel="prefetch" href="/assets/07-应用服务器的配置.html-b0eae312.js" as="script"><link rel="prefetch" href="/assets/404.html-e8479b52.js" as="script"><link rel="prefetch" href="/assets/index-e32a7948.js" as="script"><link rel="prefetch" href="/assets/giscus-52604b1e.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><!----><span class="site-name">Computer Network Learning</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/" class="" aria-label="Home"><!--[--><!--]--> Home <!--[--><!--]--></a></div><div class="navbar-item"><a href="/intro.md" class="" aria-label="Intro"><!--[--><!--]--> Intro <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://blog.cworld.top" rel="noopener noreferrer" target="_blank" aria-label="Blog"><!--[--><!--]--> Blog <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/cworld1/cn-learning" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="Search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/" class="" aria-label="Home"><!--[--><!--]--> Home <!--[--><!--]--></a></div><div class="navbar-item"><a href="/intro.md" class="" aria-label="Intro"><!--[--><!--]--> Intro <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://blog.cworld.top" rel="noopener noreferrer" target="_blank" aria-label="Blog"><!--[--><!--]--> Blog <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/cworld1/cn-learning" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">Tutorial <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/index.md" class="sidebar-item" aria-label="Home"><!--[--><!--]--> Home <!--[--><!--]--></a><!----></li><li><a href="/intro.md" class="sidebar-item" aria-label="Intro"><!--[--><!--]--> Intro <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading">Main Chapters <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/01-introduction.html" class="sidebar-item" aria-label="Chapter 1: Introduction"><!--[--><!--]--> Chapter 1: Introduction <!--[--><!--]--></a><!----></li><li><a href="/02-application-layer.html" class="sidebar-item" aria-label="Chapter 2: Application Layer"><!--[--><!--]--> Chapter 2: Application Layer <!--[--><!--]--></a><!----></li><li><a href="/03-transport-layer.html" class="sidebar-item" aria-label="Chapter 3: Transport Layer"><!--[--><!--]--> Chapter 3: Transport Layer <!--[--><!--]--></a><!----></li><li><a href="/04-network-layer.html" class="sidebar-item" aria-label="Chapter 4: Network Layer (The Data Plane)"><!--[--><!--]--> Chapter 4: Network Layer (The Data Plane) <!--[--><!--]--></a><!----></li><li><a href="/05-network-layer-2.html" class="sidebar-item" aria-label="Chapter 5: Network Layer (The Control Plane)"><!--[--><!--]--> Chapter 5: Network Layer (The Control Plane) <!--[--><!--]--></a><!----></li><li><a href="/06-link-layer-and-lans.html" class="sidebar-item" aria-label="Chapter 6: The Link Layer and LANs"><!--[--><!--]--> Chapter 6: The Link Layer and LANs <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading active">Experiments <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/experiment/00-getting-started.html" class="sidebar-item" aria-label="Getting Started"><!--[--><!--]--> Getting Started <!--[--><!--]--></a><!----></li><li><a href="/experiment/01-%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E5%8F%8A%E5%8F%8C%E7%BB%9E%E7%BA%BF%E7%9A%84%E5%88%B6%E4%BD%9C.html" class="sidebar-item" aria-label="1. 网络基础知识及双绞线的制作"><!--[--><!--]--> 1. 网络基础知识及双绞线的制作 <!--[--><!--]--></a><!----></li><li><a href="/experiment/02-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E9%85%8D%E7%BD%AE%E5%8F%8AVLAN%E5%BB%BA%E7%AB%8B.html" class="sidebar-item" aria-label="2. 交换机配置及 VLAN 建立"><!--[--><!--]--> 2. 交换机配置及 VLAN 建立 <!--[--><!--]--></a><!----></li><li><a href="/experiment/03-%E4%B8%89%E5%B1%82%E4%BA%A4%E6%8D%A2%E5%8F%8AVLAN%E9%97%B4%E8%B7%AF%E7%94%B1.html" class="sidebar-item" aria-label="3. 三层交换及 VLAN 间路由"><!--[--><!--]--> 3. 三层交换及 VLAN 间路由 <!--[--><!--]--></a><!----></li><li><a href="/experiment/04-%E8%B7%AF%E7%94%B1%E5%99%A8%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE%E5%8F%8A%E9%9D%99%E6%80%81%E8%B7%AF%E7%94%B1%E9%85%8D%E7%BD%AE.html" class="sidebar-item" aria-label="4. 路由器基本配置及静态路由配置"><!--[--><!--]--> 4. 路由器基本配置及静态路由配置 <!--[--><!--]--></a><!----></li><li><a href="/experiment/05-%E5%8A%A8%E6%80%81%E8%B7%AF%E7%94%B1%E5%8D%8F%E8%AE%AE%E7%9A%84%E9%85%8D%E7%BD%AE.html" class="sidebar-item" aria-label="5. 动态路由协议的配置"><!--[--><!--]--> 5. 动态路由协议的配置 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/experiment/06-%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%88%97%E8%A1%A8%E5%8F%8A%E9%98%B2%E7%81%AB%E5%A2%99%E4%BD%BF%E7%94%A8.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="6. 访问控制列表及防火墙使用"><!--[--><!--]--> 6. 访问控制列表及防火墙使用 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/experiment/06-%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%88%97%E8%A1%A8%E5%8F%8A%E9%98%B2%E7%81%AB%E5%A2%99%E4%BD%BF%E7%94%A8.html#实验目的" class="router-link-active router-link-exact-active sidebar-item" aria-label="实验目的"><!--[--><!--]--> 实验目的 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/experiment/06-%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%88%97%E8%A1%A8%E5%8F%8A%E9%98%B2%E7%81%AB%E5%A2%99%E4%BD%BF%E7%94%A8.html#实验原理" class="router-link-active router-link-exact-active sidebar-item" aria-label="实验原理"><!--[--><!--]--> 实验原理 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/experiment/06-%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%88%97%E8%A1%A8%E5%8F%8A%E9%98%B2%E7%81%AB%E5%A2%99%E4%BD%BF%E7%94%A8.html#实验步骤" class="router-link-active router-link-exact-active sidebar-item" aria-label="实验步骤"><!--[--><!--]--> 实验步骤 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/experiment/07-%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E9%85%8D%E7%BD%AE.html" class="sidebar-item" aria-label="7. 应用服务器的配置"><!--[--><!--]--> 7. 应用服务器的配置 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="_6-访问控制列表及防火墙使用" tabindex="-1"><a class="header-anchor" href="#_6-访问控制列表及防火墙使用" aria-hidden="true">#</a> 6. 访问控制列表及防火墙使用</h1><h2 id="实验目的" tabindex="-1"><a class="header-anchor" href="#实验目的" aria-hidden="true">#</a> 实验目的</h2><p>学习访问控制列表 ACL 的配置方法，学习防火墙的基本使用方法。</p><h2 id="实验原理" tabindex="-1"><a class="header-anchor" href="#实验原理" aria-hidden="true">#</a> 实验原理</h2><h3 id="ip-包过滤技术" tabindex="-1"><a class="header-anchor" href="#ip-包过滤技术" aria-hidden="true">#</a> IP 包过滤技术</h3><p>对路由器需要转发的数据包，先获取包头信息，然后和设定的规则进行比较，根据比较的结果对数据包进行转发或者丢弃。而实现包过滤的核心技术是访问控制列表。</p><p><img src="/assets/image-20230404211701800-741fffa8.png" alt="image-20230404211701800" loading="lazy"></p><h3 id="访问控制列表" tabindex="-1"><a class="header-anchor" href="#访问控制列表" aria-hidden="true">#</a> 访问控制列表</h3><p>访问控制列表的作用：</p><ul><li>访问控制列表可以用于防火墙；</li><li>访问控制列表可以用于 QoS（Quality of Service），对数据流量进行控制；</li><li>在 DCC 中，访问控制列表还可用来规定触发拨号的条件；</li><li>访问控制列表还可以用于地址转换；</li><li>在配置路由策略时，可以利用访问控制列表来作路由信息的过滤。</li></ul><p>访问控制列表的定义：</p><p>一个 IP 数据包如下图所示（图中 IP 所承载的上层协议为 TCP/UDP）：</p><p><img src="/assets/image-20230404212038243-5654dc9d.png" alt="image-20230404212038243" loading="lazy"></p><div class="custom-container tip"><p>对于 TCP/UDP 来说，这 5 个元素组成了一个 TCP/UDP 相关，访问控制列表就是利用这些元素定义的规则</p></div><p>访问控制列表的分类：</p><p>按照访问控制列表的用途可以分为四类:</p><ul><li>基本的访问控制列表（basic acl）</li><li>高级的访问控制列表（advanced acl）</li><li>基于接口的访问控制列表（interface-based acl）</li><li>基于 MAC 的访问控制列表（mac-based acl）</li></ul><p>访问控制列表的标识：</p><ul><li>利用数字标识访问控制列表</li><li>利用数字范围标识访问控制列表的种类</li></ul><table><thead><tr><th>列表的种类</th><th>数字标识的范围</th></tr></thead><tbody><tr><td>基于接口的访问控制列表</td><td>1000 ～ 1999</td></tr><tr><td>基本的访问控制列表</td><td>2000 ～ 2999</td></tr><tr><td>高级的访问控制列表</td><td>3000 ～ 3999</td></tr><tr><td>基于 MAC 地址访问控制列表</td><td>4000 ～ 4999</td></tr></tbody></table><h3 id="基本访问控制列表" tabindex="-1"><a class="header-anchor" href="#基本访问控制列表" aria-hidden="true">#</a> 基本访问控制列表</h3><p>基本访问控制列表只使用源地址描述数据，表明是允许还是拒绝。</p><p>配置基本访问列表的命令格式如下：</p><ul><li><code>acl number &lt;acl-number&gt; (match-order {config|auto})</code></li><li><code>rule (rule-id) {permit|deny} [source sour-addr sour-wildcard|any] [time-range time-name] [logging] [fragment] [vpn-instance vpn-instanc-name]</code></li></ul><p>反掩码和子网掩码相似，但写法不同：</p><ul><li>0 表示需要比较</li><li>1 表示忽略比较</li></ul><p>反掩码和 IP 地址结合使用，可以描述一个地址范围：</p><table><thead><tr><th>First quarter</th><th>Second quarter</th><th>Third quarter</th><th>Last quarter</th><th>Comment</th></tr></thead><tbody><tr><td>0</td><td>0</td><td>0</td><td>255</td><td>只比较前 24 位</td></tr><tr><td>0</td><td>0</td><td>3</td><td>255</td><td>只比较前 22 位</td></tr><tr><td>0</td><td>255</td><td>255</td><td>255</td><td>只比较前 8 位</td></tr></tbody></table><p>反掩码的实质：<strong>根据掩码，按位取反</strong></p><p>如：</p><ul><li>匹配 192.168.0.0 /16 网段，反掩码应该为 0.0.255.255</li><li>匹配 192.168.1.0 /26 网段，反掩码应该为 0.0.0.(255-192)=0.0.0.63</li><li>0.0.0.0 0.0.0.0 匹配所有地址，等同于 any</li><li>192.168.1.5 0.0.0.0 匹配单独的 ip 地址</li><li>192.168.1.5 255.255.255.255 根据反掩码，都不匹配，也等同于 any</li></ul><p>实例如：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>acl number <span class="token number">2000</span>
rule <span class="token number">1</span> deny <span class="token builtin class-name">source</span> <span class="token number">192.110</span>.10.0 <span class="token number">0.0</span>.0.255
rule <span class="token number">2</span> permit <span class="token builtin class-name">source</span> <span class="token number">202.110</span>.10.0 <span class="token number">0.0</span>.0.255
rule <span class="token number">3</span> permit <span class="token builtin class-name">source</span> any
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/assets/image-20230406111834389-0f436a92.png" alt="image-20230406111834389" loading="lazy"></p><h3 id="高级访问控制列表" tabindex="-1"><a class="header-anchor" href="#高级访问控制列表" aria-hidden="true">#</a> 高级访问控制列表</h3><p>高级访问控制列表使用除源地址外更多的信息描述数据包，表明是允许还是拒绝。</p><p>高级访问控制列表规则的配置命令：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>rule <span class="token punctuation">[</span>rule-id<span class="token punctuation">]</span> <span class="token punctuation">{</span>permit<span class="token operator">|</span>deny<span class="token punctuation">}</span> protocol
   <span class="token punctuation">[</span>source sour-addr sour-wildcard<span class="token operator">|</span>any<span class="token punctuation">]</span>
   <span class="token punctuation">[</span>destination dest-addr dest-mask<span class="token operator">|</span>any<span class="token punctuation">]</span>
   <span class="token punctuation">[</span>soucre-port operator port1 <span class="token punctuation">(</span>port2<span class="token punctuation">)</span><span class="token punctuation">]</span>
   <span class="token punctuation">[</span>destination-port operator port1<span class="token punctuation">(</span>port2<span class="token punctuation">)</span><span class="token punctuation">]</span>
   <span class="token punctuation">[</span>icmp-type <span class="token punctuation">{</span>icmp-message<span class="token operator">|</span>icmp-type icmp-code<span class="token punctuation">}</span><span class="token punctuation">]</span>
   <span class="token punctuation">[</span>precedence precedence<span class="token punctuation">]</span> <span class="token punctuation">[</span>tos tos<span class="token punctuation">]</span> <span class="token punctuation">[</span>time-range time-name<span class="token punctuation">]</span>
   <span class="token punctuation">[</span>logging<span class="token punctuation">]</span> <span class="token punctuation">[</span>fragment<span class="token punctuation">]</span> <span class="token punctuation">[</span>vpn-instance vpn-instanc-name<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>其中：</p><table><thead><tr><th>操作符及语法</th><th>意义</th></tr></thead><tbody><tr><td>eq portnumber</td><td>等于端口号 portnumber</td></tr><tr><td>gt portnumber</td><td>大于端口号 portnumber</td></tr><tr><td>lt portnumber</td><td>小于端口号 portnumber</td></tr><tr><td>neq portnumber</td><td>不等于端口号 portnumber</td></tr><tr><td>range portnumber1 portnumber2</td><td>介于端口号 portnumber1 和 portnumber2 之间</td></tr></tbody></table><p>如：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>acl number <span class="token number">3000</span>
rule <span class="token number">1</span> permit tcp <span class="token builtin class-name">source</span> <span class="token number">202.110</span>.10.0 <span class="token number">0.0</span>.0.255 destination <span class="token number">179.100</span>.17.10 <span class="token number">0.0</span>.0.0 destination-port eq www
rule <span class="token number">2</span> deny <span class="token function">ip</span> <span class="token builtin class-name">source</span> any destionation any
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/assets/image-20230406111251960-09e3e29a.png" alt="image-20230406111251960" loading="lazy"></p><p>或是：</p><ul><li><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>rule deny icmp <span class="token builtin class-name">source</span> <span class="token number">10.1</span>.0.0 <span class="token number">0.0</span>.255.255 destination any icmp-type host-redirect
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/assets/image-20230406112024277-db312d24.png" alt="image-20230406112024277" loading="lazy"></p></li><li><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>rule deny tcp <span class="token builtin class-name">source</span> <span class="token number">129.9</span>.0.0 <span class="token number">0.0</span>.255.255 destination <span class="token number">202.38</span>.160.0 <span class="token number">0.0</span>.0.255 destination-port eq www
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/assets/image-20230406112048633-7d019a25.png" alt="image-20230406112048633" loading="lazy"></p></li></ul><h3 id="访问控制列表的显示" tabindex="-1"><a class="header-anchor" href="#访问控制列表的显示" aria-hidden="true">#</a> 访问控制列表的显示</h3><p>访问控制列表的显示与调试：</p><ul><li>display acl {all|acl-number}</li><li>reset acl counter {all|acl-number}</li></ul><h3 id="访问控制列表的匹配规则" tabindex="-1"><a class="header-anchor" href="#访问控制列表的匹配规则" aria-hidden="true">#</a> 访问控制列表的匹配规则</h3><p>一条访问列表可以由多条规则组成，对于这些规则，有两种匹配顺序：auto 和 config。规则冲突时，若匹配顺序为 auto（深度优先），描述的地址范围越小的规则，将会优先考虑。</p><blockquote><p>深度的判断要依靠通配比较位和 IP 地址结合比较：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>rule deny <span class="token number">202.38</span>.0.0  <span class="token number">0.0</span>.255.255
rule permit <span class="token number">202.38</span>.160.0  <span class="token number">0.0</span>.0.255
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>两条规则结合则表示禁止一个大网段 （202.38.0.0）上的主机但允许其中的一小部分主 机（202.38.160.0）的访问。</p></blockquote><p>规则冲突时，若匹配顺序为 config，先配置的规则会被优先考虑。</p><div class="custom-container tip"><p>“深度优先” 原则的具体标准如下：</p><ul><li>对于基本访问控制列表的规则，直接比较源地址通配符，通配符相同的按配置顺序；</li><li>对基于接口过滤的访问控制规则，配置了 any 的规则排在后面，其他的按配置顺序；</li><li>对于高级访问控制规则，首先比较源地址通配符，相同的再比较目的地址通配符，仍相同比较端口号范围，范围小的排在前面，如果都相同就按配置顺序。</li></ul></div><h3 id="访问控制列表的使用" tabindex="-1"><a class="header-anchor" href="#访问控制列表的使用" aria-hidden="true">#</a> 访问控制列表的使用</h3><p>防火墙配置常见步骤：</p><ul><li>启用防火墙</li><li>定义访问控制列表</li><li>将访问控制列表应用到接口上</li></ul><p>对应命令：</p><ul><li><p>打开或者关闭防火墙：<code>firewall {enable|disable}</code></p></li><li><p>设置防火墙的缺省过滤模式：<code>firewall default {permit|deny}</code></p></li><li><p>显示防火墙的统计信息：</p><p><code>display firewall-statistics {all|interface interface-name|fragments-inspect}</code></p></li><li><p>打开防火墙包过滤调试信息开关：</p><p><code>debugging firewall {all|icmp|tcp|udp|others} [interface interface-name]</code></p></li></ul><p>在接口上应用访问控制列表：</p><ul><li><p>将访问控制列表应用到接口上</p></li><li><p>指明在接口上是 OUT 还是 IN 方向</p></li><li><p>在接口视图下配置：</p><p><code>firewall packet-filter acl-number {inbound|outbound} [match-fragments {normally|exactly}]</code></p></li></ul><p><img src="/assets/image-20230406113249538-0d802446.png" alt="image-20230406113249538" loading="lazy"></p><p>如：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>acl num <span class="token number">3000</span>
rule deny icmp <span class="token builtin class-name">source</span> <span class="token number">202.110</span>.10.1 <span class="token number">0.0</span>.0.255 destination <span class="token number">179.100</span>.17.10 <span class="token number">0.0</span>.0.0 icmp-type echo-reply
firewall <span class="token builtin class-name">enable</span>
interface e <span class="token number">0</span>
firewall packet-filter <span class="token number">3000</span> inbound
interface s <span class="token number">0</span>
firewall packet-filter <span class="token number">3000</span> outbound
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="实验步骤" tabindex="-1"><a class="header-anchor" href="#实验步骤" aria-hidden="true">#</a> 实验步骤</h2><p>按图示搭建网络环境：</p><p><img src="/assets/image-20230406113344329-0895e576.png" alt="image-20230406113344329" loading="lazy"></p><p>在 R1 上设置：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>acl num <span class="token number">3000</span>
rule deny <span class="token function">ip</span> <span class="token builtin class-name">source</span> <span class="token number">202.0</span>.0.0 <span class="token number">0.0</span>.0.255 destination <span class="token number">202.0</span>.1.0 <span class="token number">0.0</span>.0.255
firewall <span class="token builtin class-name">enable</span>
interface e <span class="token number">0</span>
firewall packet-filter <span class="token number">3000</span> inbound
interface s <span class="token number">0</span>
firewall packet-filter <span class="token number">3000</span> outbound
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!--[--><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/cworld1/cn-learning/edit/main/experiment/06-访问控制列表及防火墙使用.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page"><!--[--><!--]--> Edit this page <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: cworld0@qq.com">cworld1</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/experiment/05-%E5%8A%A8%E6%80%81%E8%B7%AF%E7%94%B1%E5%8D%8F%E8%AE%AE%E7%9A%84%E9%85%8D%E7%BD%AE.html" class="" aria-label="5. 动态路由协议的配置"><!--[--><!--]--> 5. 动态路由协议的配置 <!--[--><!--]--></a></span><span class="next"><a href="/experiment/07-%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E9%85%8D%E7%BD%AE.html" class="" aria-label="7. 应用服务器的配置"><!--[--><!--]--> 7. 应用服务器的配置 <!--[--><!--]--></a></span></p></nav><!--[--><!--[--><div class="giscus-wrapper input-top" id="comment" style="display:block;"><div class="loading-icon-wrapper" style="display:flex;align-items:center;justify-content:center;height:96px"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><p class="my-footer" style="text-align:center;"> ©2023 • <a href="https://cworld.top/">CWorld</a> • 总访问 <span id="busuanzi_value_site_pv"></span> 次 </p><!--]--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app-179c21db.js" defer></script>
  </body>
</html>
